<div class="workspace">
  <app-topbar
    class="topbar-wrapper"
    [projectName]="projectName"
    (newArchitecture)="onNewArchitecture()"
    (projectNameChange)="onProjectNameChange($event)"
  ></app-topbar>

  <div class="body">
    <div class="sidebar">
      <app-service-palette></app-service-palette>
    </div>

    <div class="main-content">
      <!-- Canvas -->
      <div class="canvas-wrapper">
        <app-canvas #canvas></app-canvas>

        <!-- ===== Gaveta do prompt colada no lado ESQUERDO do grid ===== -->
        <div class="prompt-float" [class.open]="promptOpen">
          <button class="prompt-toggle"
                  (click)="togglePrompt()"
                  [attr.aria-expanded]="promptOpen"
                  aria-label="Abrir/fechar prompt de IA">
            <span *ngIf="!promptOpen">▶</span>
            <span *ngIf="promptOpen">◀</span>
          </button>

          <div class="prompt-card" (click)="$event.stopPropagation()">
            <app-ia-prompt
              [loading]="promptLoading"
              [response]="promptResponse"
              [error]="promptError"
              (promptSubmit)="onPromptSubmit($event)"
              (replace)="onPromptReplace()"
            ></app-ia-prompt>

          </div>
        </div>
        <!-- ===== FIM da gaveta ===== -->
      </div>

      <!-- Preview à direita -->
      <div class="terraform-wrapper">
        <app-terraform-preview></app-terraform-preview>
      </div>
    </div>
  </div>
</div>
