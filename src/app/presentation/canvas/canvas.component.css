.controls { margin-bottom: 8px; }
.icon-btn { border: none; background: none; padding: 6px; cursor: pointer; margin-right: 8px; }
.icon-btn-img { width: 24px; height: 24px; opacity: 0.6; }
.icon-btn.active .icon-btn-img, .icon-btn:hover .icon-btn-img { opacity: 1; }

/* Canvas fixo; pan/zoom ocorrem na .viewport */
.canvas {
  position: relative;
  width: 100%;
  min-height: 100vh; /* fundo infinito */
  overflow: hidden;
  cursor: crosshair;
  background:
    radial-gradient(#d8d8d8 1px, transparent 1px),
    radial-gradient(#d8d8d8 1px, transparent 1px);
  background-size: 20px 20px;
  background-position: 0 0, 10px 10px;
  background-color: #f7f7f9;
}

/* “Tapete” grande para trabalhar longe sem limite */
.viewport {
  position: absolute;
  inset: 0;
  will-change: transform;
  min-width: 8000px;
  min-height: 8000px;
  background: transparent;
}

/* Linhas */
.connections { position: absolute; inset: 0; width: 100%; height: 100%; z-index: 1; }
.hit-area { stroke: transparent; stroke-width: 12px; pointer-events: stroke; cursor: pointer; }
.visible-line { stroke: #0f1a2a; stroke-width: 2.4px; pointer-events: none; }
.visible-line.solid { stroke-dasharray: none; }
.visible-line.dashed { stroke-dasharray: 6 6; }
.visible-line.preview { stroke: #2b6fff; stroke-width: 2px; stroke-dasharray: 6 6; }

/* Nodes */
.node {
  position: absolute;
  width: 108px;
  height: 96px;
  transform: translate(-50%, -50%); /* ancora no centro */
  display: flex; flex-direction: column; align-items: center;
  padding: 8px 12px;
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 1px 0 rgba(0,0,0,.08), 0 8px 24px rgba(39,48,77,.10);
  border: 1px solid #e9e9ef;
  user-select: none;
  cursor: grab;
  z-index: 2;
}
.node:active { cursor: grabbing; }
.node-icon { width: 44px; height: 44px; object-fit: contain; margin-top: 6px; }
.node-label { margin-top: 6px; font-weight: 700; font-size: 13px; color: #0f172a; text-align: center; }

/* === Portas: clicáveis e bonitas === */
.port {
  position: absolute;
  width: 12px;
  height: 12px;
  border-radius: 9999px;           /* 100% circular */
  background: #fff;                /* miolo branco */
  border: 2px solid #2b6fff;       /* aro azul */
  box-shadow:
    0 2px 6px rgba(22, 36, 72, .12),    /* sombra suave */
    0 0 0 3px rgba(43, 111, 255, .12);  /* glow externo leve */
  opacity: 0;
  pointer-events: none;            /* habilito nas regras abaixo */
  transition: transform .14s ease, box-shadow .14s ease, background-color .14s ease, opacity .12s ease;
  z-index: 10;                     /* acima de linhas/SVG */
}

/* miolinho azul */
.port::after {
  content: "";
  position: absolute;
  inset: 3px;
  border-radius: inherit;
  background: #2b6fff;
}

/* HIT-AREA invisível ampliada (28x28) – facilita o clique mesmo no zoom-out */
.port::before {
  content: "";
  position: absolute;
  left: 50%; top: 50%;
  width: 28px; height: 28px;
  transform: translate(-50%, -50%);
  border-radius: 9999px;
  background: transparent;
  pointer-events: auto; /* captura clique */
}

/* mostrar e habilitar clique:
   - ao passar o mouse no node
   - quando está ligando (canvas.linking)
   - quando forçado por .show-ports */
.node:hover .port,
.canvas.linking .port,
.canvas.show-ports .port {
  opacity: 1;
  pointer-events: auto;
}

/* Hover/press com hit-area grande */
.port:hover,
.port:focus-visible {
  transform: scale(1.18);
  box-shadow:
    0 4px 14px rgba(22, 36, 72, .18),
    0 0 0 5px rgba(43, 111, 255, .22);
  background: #f6f9ff;
}
.port:active { transform: scale(1.08); background: #eaf1ff; }

/* Posicionamento (12px + 2px borda = 16px) */
.port.top    { top: -8px;    left: 50%; transform: translate(-50%, -50%); }
.port.right  { right: -8px;  top: 50%;  transform: translate(50%, -50%);  }
.port.bottom { bottom: -8px; left: 50%; transform: translate(-50%, 50%);  }
.port.left   { left: -8px;   top: 50%;  transform: translate(-50%, -50%); }

/* Modos */
.canvas.service-delete-mode { cursor: pointer; }

.icon-btn i {
  font-size: 26px;
  color: #000000;
  transition: opacity .2s;
}

.icon-btn.active i,
.icon-btn:hover i {
  opacity: 1;
  color: #2b6fff; /* azul no hover/ativo */
}
